<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

  
<mapper namespace="VideoBBS">
	<insert id="videoBbsWrite" parameterType="kh.com.a.model.VideoBBSDto">
	INSERT INTO VIDEOBBS(ID, TITLE, CONTENT, VIDEO, THUMBNAIL, WDATE, READCOUNT, VIDEO_SEQ)
	VALUES(#{id}, #{title}, #{content}, #{video}, #{thumbnail}, SYSDATE, 0, VIDEO_SEQ.NEXTVAL)
	</insert>
	
	<select id="getVideoBbsList" resultType="kh.com.a.model.VideoBBSDto">
	SELECT  ID, TITLE, CONTENT, VIDEO, THUMBNAIL, WDATE, READCOUNT, VIDEO_SEQ 
	FROM VIDEOBBS
	</select>
	
	<select id="getVideoBbs" resultType="kh.com.a.model.VideoBBSDto">
	SELECT  ID, TITLE, CONTENT, VIDEO, THUMBNAIL, WDATE, READCOUNT, VIDEO_SEQ
	FROM VIDEOBBS
	WHERE VIDEO_SEQ=#{video_seq}
	</select>
	
	<!-- 비로그인 유저 / 로그인 유저 (공통) -->
	<!-- 1. 뮤지션 Table (뮤지션 별 업로드 영상의 누적 좋아요 순 랭킹 정렬) -->
	<select id="getVideoRank" resultType="kh.com.a.model.VideoBBSDto">
							
		SELECT VB.ID, VB.TITLE, VB.CONTENT, VB.VIDEO, VB.WDATE, VB.VIDEO_SEQ FROM VIDEOBBS VB,
					(SELECT VIDEO_SEQ, COUNT(MEMID) TOTAL FROM VIDEO_LIKE 
					GROUP BY VIDEO_SEQ ORDER BY COUNT(MEMID)) VL 
					WHERE VB.VIDEO_SEQ = VL.VIDEO_SEQ ORDER BY TOTAL DESC
							
	</select>
	
	
	<!-- 메인페이지 
	1. 뮤지션 Table (뮤지션 별 업로드 영상의 누적 좋아요 순 랭킹 정렬)
	2. Schedule BBS (시작날짜 <>= SYSDATE 조건 -> SYSDATE기준 시작날짜가 임박한 데이터 // 현재날짜에 가까운 순 정렬) 
	3. Schedule BBS (종료날짜 <>= SYSDATE 조건 -> SYSDATE기준 시작날짜가 초과했지만 종료날짜가 지나지 않은 데이터 // 종료임박 데이터 순 정렬) 
	-->
	<!-- 1. 뮤지션 Table (뮤지션 별 업로드 한 게시글의 누적 좋아요 순 랭킹 정렬)
	2. Session login 개인정보의 선호장르에 일치하는 Video 데이터 (좋아요 순?) 
	3. Session login 개인정보의 Location에 일치하는 행사 데이터
	 -->
	
</mapper>